<%- include('partials/header') %>

<div class="container mt-4">
    <h2>Job Application Details</h2>
    <% if (typeof job !== 'undefined' && job) { %>
        <div class="card">
            <div class="card-header">
                <h4><%= job.appliedPosition %> at <%= job.companyName %></h4>
            </div>
            <div class="card-body">
                <p><strong>Company Name:</strong> <%= job.companyName %></p>
                <p><strong>Applied Position:</strong> <%= job.appliedPosition %></p>
                <p><strong>Date Applied:</strong> <%= new Date(job.dateApplied).toLocaleDateString() %></p>
                <p><strong>Status:</strong> <%= job.statusText %></p> <%# Assuming statusText is provided by controller %>
                <p><strong>Company Address:</strong> <%= job.companyAddress || 'N/A' %></p>
                <p><strong>Country:</strong> <%= job.countryName || 'N/A' %></p> <%# Assuming countryName is from the join %>
                <p><strong>Company Website:</strong> 
                    <% if (job.companyWebsite) { %>
                        <a href="<%= job.companyWebsite %>" target="_blank"><%= job.companyWebsite %></a>
                    <% } else { %>
                        N/A
                    <% } %>
                </p>
                <p><strong>Additional Notes:</strong></p>
                <p><%- job.additionalNotes ? job.additionalNotes.replace(/\n/g, '<br>') : 'N/A' %></p>
                <p><small><em>Last updated: <%= new Date(job.updatedAt).toLocaleString() %></em></small></p>
                <p><small><em>Created: <%= new Date(job.createdAt).toLocaleString() %></em></small></p>
            </div>
            <div class="card-footer">
                <a href="/" class="btn btn-primary">Back to Dashboard</a>
                </div>
        </div>
    <% } else { %>
        <div class="alert alert-warning" role="alert">
            Job details not found or an error occurred.
        </div>
        <a href="/" class="btn btn-primary">Back to Dashboard</a>
    <% } %>
</div>

<%- include('partials/footer') %>